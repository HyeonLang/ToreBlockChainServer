# 📖 Manual 4: 프론트엔드 구조 및 사용법

## 🎨 프론트엔드 개요

ToreBlockChainServer의 프론트엔드는 완전한 NFT 관리 시스템을 제공하는 웹 애플리케이션입니다. MetaMask 지갑 연동을 통해 블록체인과 직접 상호작용하며, 사용자 친화적인 인터페이스로 NFT의 생성, 전송, 삭제, 조회 및 거래 이력 확인이 가능합니다.

### 🌟 주요 특징

- **완전한 NFT 관리**: 생성부터 거래 이력까지 모든 기능
- **MetaMask 자동 연동**: 지갑 연결 및 주소 자동 입력
- **실시간 상태 표시**: 모든 작업의 진행 상황을 실시간으로 표시
- **통합 조회 기능**: 조회 결과에서 바로 관련 정보 확인
- **반응형 디자인**: 모바일과 데스크톱 모두 지원
- **🆕 마켓 시스템**: NFT 판매 등록, 구매, 취소 기능 (신규 추가)

## 🏗️ 프론트엔드 구조

### 디렉토리 구조

```
frontend/
└── 📁 public/
    ├── 📄 index.html              # 메인 페이지
    ├── 📄 exchange.html           # 거래소 페이지
    ├── 📁 css/
    │   └── 📄 exchange.css        # 거래소 스타일
    └── 📁 js/
        ├── 📄 app.js              # 메인 애플리케이션
        ├── 📄 auctionManager.js   # 경매 관리
        ├── 📄 exchangeApp.js      # 거래소 앱
        ├── 📄 exchangeManager.js  # 거래소 관리
        ├── 📄 nftManager.js       # NFT 관리
        ├── 📄 toreTokenManager.js # TORE 토큰 관리
        ├── 📄 utils.js            # 유틸리티 함수
        └── 📄 walletManager.js    # 지갑 관리
```

### 페이지 구성

#### 1. **메인 페이지** (`index.html`)
- **URL**: `http://localhost:3000`
- **기능**: NFT 생성, 전송, 삭제, 조회
- **대상**: 일반 사용자

#### 2. **거래소 페이지** (`exchange.html`)
- **URL**: `http://localhost:3000/exchange.html`
- **기능**: NFT 거래, 마켓 시스템
- **대상**: 거래자

## 🚀 시작하기

### 1. 접속
브라우저에서 `http://localhost:3000` 접속

### 2. MetaMask 연결
1. "메타마스크 지갑 연결" 버튼 클릭
2. MetaMask 팝업에서 계정 선택 및 연결 승인
3. 연결된 지갑 주소가 자동으로 입력됨

### 3. 기본 설정 확인
- 서버 상태: 정상 연결 시 "서버 연결 상태: 정상" 표시
- 컨트랙트 주소: 자동으로 로드됨
- 지갑 주소: 연결된 주소가 상단에 표시됨

## 📑 메인 페이지 기능

### 🎨 NFT 관리 탭

#### 1. **NFT 생성**
**목적**: 새로운 NFT 생성 (민팅)

**사용 방법**:
1. **받는 주소**: NFT를 받을 지갑 주소 (연결된 지갑 주소가 자동 입력)
2. **토큰 URI**: NFT 메타데이터 URI 입력
   - 예시: `https://ipfs.io/ipfs/QmYourMetadataHash`
   - 또는: `ipfs://QmYourMetadataHash`
3. **"NFT 생성하기"** 버튼 클릭
4. MetaMask에서 트랜잭션 승인
5. 생성 완료 후 자동으로 지갑에 NFT 추가

#### 2. **NFT 전송**
**목적**: 기존 NFT를 다른 지갑으로 전송

**사용 방법**:
1. **보내는 주소**: NFT를 보내는 지갑 주소
2. **받는 주소**: NFT를 받을 지갑 주소
3. **토큰 ID**: 전송할 NFT의 토큰 ID
4. **"NFT 전송하기"** 버튼 클릭
5. MetaMask에서 트랜잭션 승인

#### 3. **NFT 삭제**
**목적**: NFT 소각 (영구 삭제)

**사용 방법**:
1. **토큰 ID**: 삭제할 NFT의 토큰 ID 입력
2. **"NFT 삭제하기"** 버튼 클릭
3. 확인 팝업에서 승인
4. MetaMask에서 트랜잭션 승인

### 🔍 조회 및 정보 탭

#### 1. **NFT 정보 조회**
**목적**: 특정 NFT의 기본 정보 조회

**표시 정보**:
- **소유자**: 현재 NFT를 소유한 지갑 주소
- **토큰 URI**: NFT 메타데이터 URI
- **거래 이력 보기**: 해당 NFT의 거래 내역 조회

#### 2. **지갑 NFT 조회**
**목적**: 특정 지갑이 소유한 모든 NFT 조회

**표시 정보**:
- **NFT 목록**: 소유한 모든 NFT의 정보
- **각 NFT 정보**: 토큰 ID, 소유자, URI
- **거래 이력 보기**: 해당 지갑의 모든 NFT 거래 내역

#### 3. **NFT 거래 이력 조회**
**목적**: 특정 NFT의 모든 거래 내역 조회

**표시 정보**:
- **거래 타입**: 민팅, 전송, 소각
- **주소 정보**: 보내는 주소, 받는 주소
- **토큰 정보**: 토큰 ID
- **블록체인 정보**: 블록 번호, 트랜잭션 해시
- **시간 정보**: 거래 발생 시간

#### 4. **지갑 거래 이력 조회**
**목적**: 특정 지갑의 모든 NFT 거래 내역 조회

**표시 정보**:
- **거래 타입**: 민팅, 전송, 소각
- **거래 방향**: 보냄, 받음
- **주소 정보**: 보내는 주소, 받는 주소
- **토큰 정보**: 토큰 ID
- **블록체인 정보**: 블록 번호, 트랜잭션 해시
- **시간 정보**: 거래 발생 시간 (최신순 정렬)

### 💰 TORE 토큰 탭

#### 1. **잔액 조회**
**목적**: 특정 지갑의 TORE 토큰 잔액 확인

#### 2. **토큰 전송**
**목적**: TORE 토큰을 다른 지갑으로 전송

#### 3. **전송 내역**
**목적**: TORE 토큰 전송 내역 조회

## 🏪 거래소 페이지 기능

### 거래소 페이지 (`exchange.html`)

**URL**: `http://localhost:3000/exchange.html`

#### 주요 기능:
- **NFT 거래**: 기존 거래소 기능
- **🆕 마켓 시스템**: NFT 판매 등록, 구매, 취소

### 🆕 마켓 시스템 기능

#### 1. **NFT 판매 등록**
- 소유한 NFT를 마켓에 등록하여 판매
- 판매 가격 설정 (TORE 토큰 단위)
- 판매 등록 ID 생성

#### 2. **판매 등록 취소**
- 등록된 NFT 판매를 취소
- 판매자만 취소 가능

#### 3. **NFT 구매**
- 마켓에서 NFT 구매
- 구매 시 자동으로 NFT 소유권 이전
- 판매자에게 TORE 토큰 전송

#### 4. **마켓 목록 조회**
- 현재 판매 중인 NFT 목록
- 가격, 판매자, 생성일 등 정보 표시

#### 5. **사용자 거래 내역**
- 판매 등록 내역
- 구매 내역
- 거래 상태별 필터링

## 🔗 통합 기능

### 1. NFT 정보에서 거래 이력 보기
1. **개별조회** 탭에서 NFT 정보 조회
2. 결과 하단의 **"거래 이력 보기"** 버튼 클릭
3. 자동으로 **NFT거래이력** 탭으로 전환
4. 토큰 ID 자동 입력 및 거래 이력 조회

### 2. 지갑 조회에서 거래 이력 보기
1. **지갑조회** 탭에서 지갑 NFT 조회
2. 결과 하단의 **"거래 이력 보기"** 버튼 클릭
3. 자동으로 **지갑거래이력** 탭으로 전환
4. 지갑 주소 자동 입력 및 거래 이력 조회

## 🎨 UI/UX 특징

### 1. 반응형 디자인
- **데스크톱**: 넓은 화면에서 최적화된 레이아웃
- **모바일**: 터치 친화적인 인터페이스
- **태블릿**: 중간 크기 화면에 적합한 배치

### 2. 시각적 피드백
- **로딩 애니메이션**: 작업 진행 중 스피너 표시
- **상태 메시지**: 성공/오류/정보 메시지 색상 구분
- **버튼 상태**: 비활성화/활성화 상태 명확히 구분

### 3. 사용자 편의성
- **자동 입력**: 지갑 연결 시 관련 필드 자동 채움
- **입력 검증**: 실시간 입력값 검증 및 오류 메시지
- **원클릭 조회**: 통합 기능으로 관련 정보 쉽게 확인

### 4. 정보 표시
- **카드 형태**: 정보를 깔끔하게 정리된 카드로 표시
- **색상 코딩**: 거래 타입과 방향을 색상으로 구분
- **링크 연결**: 트랜잭션 해시 클릭 시 SnowTrace에서 상세 확인

## 🛠️ 기술적 세부사항

### 사용된 기술
- **HTML5**: 시맨틱 마크업
- **CSS3**: Flexbox, Grid, 애니메이션
- **Vanilla JavaScript**: ES6+ 문법
- **Ethers.js**: 블록체인 상호작용
- **MetaMask API**: 지갑 연동

### 주요 JavaScript 파일

#### 1. **app.js** - 메인 애플리케이션
```javascript
class NFTMinter {
    // 메인 클래스
    - init(): 초기화
    - connectWallet(): MetaMask 연결
    - createNFT(): NFT 생성
    - transferNFT(): NFT 전송
    - deleteNFT(): NFT 삭제
    - getNFTInfo(): NFT 정보 조회
    - getWalletNFTs(): 지갑 NFT 조회
    - getNftTransactionHistory(): NFT 거래 이력 조회
    - getWalletTransactionHistory(): 지갑 거래 이력 조회
}
```

#### 2. **walletManager.js** - 지갑 관리
- MetaMask 연결 및 관리
- 지갑 주소 자동 입력
- 네트워크 확인

#### 3. **nftManager.js** - NFT 관리
- NFT 생성, 전송, 삭제
- NFT 정보 조회
- 거래 이력 관리

#### 4. **toreTokenManager.js** - TORE 토큰 관리
- 토큰 잔액 조회
- 토큰 전송
- 전송 내역 조회

#### 5. **exchangeManager.js** - 거래소 관리
- 거래 생성, 구매, 취소
- 거래 정보 조회
- 거래소 통계

#### 6. **utils.js** - 유틸리티 함수
- 공통 함수들
- API 호출 헬퍼
- 에러 처리

### API 엔드포인트

#### NFT 관련
- `POST /api/nft/mint` - NFT 생성
- `POST /api/nft/transfer` - NFT 전송
- `POST /api/nft/burn` - NFT 삭제
- `GET /api/nft/:tokenId` - NFT 정보 조회
- `GET /api/nft/wallet` - 지갑 NFT 조회
- `GET /api/nft/:tokenId/history` - NFT 거래 이력 조회
- `GET /api/nft/wallet/history` - 지갑 거래 이력 조회

#### TORE 토큰 관련
- `GET /api/tore/info` - 토큰 정보
- `GET /api/tore/balance/:address` - 잔액 조회
- `POST /api/tore/transfer` - 토큰 전송
- `GET /api/tore/history/:address` - 전송 내역

#### 거래소 관련
- `POST /api/exchange/create-trade` - 거래 생성
- `POST /api/exchange/buy-nft` - NFT 구매
- `POST /api/exchange/cancel-trade` - 거래 취소
- `GET /api/exchange/trade/:tradeId` - 거래 정보
- `GET /api/exchange/user-trades/:address` - 사용자 거래 목록
- `GET /api/exchange/active-trades` - 활성 거래 목록
- `GET /api/exchange/stats` - 거래소 통계

#### 🆕 마켓 관련
- `POST /api/market/list-nft` - NFT 판매 등록
- `POST /api/market/cancel-listing` - 판매 등록 취소
- `POST /api/market/buy-nft` - NFT 구매
- `GET /api/market/listings` - 판매 중인 NFT 목록
- `GET /api/market/listing/:listingId` - 특정 판매 등록 정보
- `GET /api/market/user-listings/:address` - 사용자 판매 등록 목록
- `GET /api/market/user-purchases/:address` - 사용자 구매 내역
- `GET /api/market/stats` - 마켓 통계

## 🔧 문제 해결

### 1. MetaMask 연결 문제
**증상**: 지갑 연결이 안 됨
**해결방법**:
- MetaMask 확장 프로그램이 설치되어 있는지 확인
- 브라우저에서 MetaMask가 활성화되어 있는지 확인
- 팝업 차단 설정 확인

### 2. 서버 연결 문제
**증상**: "서버에 연결할 수 없습니다" 메시지
**해결방법**:
- 서버가 실행 중인지 확인 (`npm run dev`)
- 포트 3000이 사용 중인지 확인
- 방화벽 설정 확인

### 3. 트랜잭션 실패
**증상**: MetaMask에서 트랜잭션이 실패함
**해결방법**:
- 가스비가 충분한지 확인
- 네트워크가 올바른지 확인 (Avalanche Fuji 테스트넷)
- 컨트랙트 주소가 설정되어 있는지 확인

### 4. 거래 이력 조회 실패
**증상**: 거래 이력이 표시되지 않음
**해결방법**:
- 토큰 ID가 올바른지 확인
- 지갑 주소 형식이 올바른지 확인
- 해당 NFT나 지갑에 거래 이력이 있는지 확인

## 📱 모바일 사용 팁

### 1. 화면 회전
- 가로 모드에서 더 나은 사용 경험
- 세로 모드에서도 모든 기능 사용 가능

### 2. 터치 조작
- 버튼 크기가 터치하기 적절하게 설계됨
- 스크롤이 필요한 영역은 명확히 표시됨

### 3. MetaMask 모바일
- MetaMask 모바일 앱과 연동 가능
- QR 코드를 통한 연결도 지원

## 🎯 사용 시나리오

### 시나리오 1: 새로운 NFT 생성
1. MetaMask 연결
2. 생성 탭에서 토큰 URI 입력
3. NFT 생성하기 클릭
4. MetaMask에서 승인
5. 생성된 NFT 확인

### 시나리오 2: NFT 전송
1. 전송 탭에서 주소와 토큰 ID 입력
2. NFT 전송하기 클릭
3. MetaMask에서 승인
4. 전송 완료 확인

### 시나리오 3: 거래 이력 확인
1. 개별조회에서 NFT 정보 조회
2. 거래 이력 보기 클릭
3. 모든 거래 내역 확인
4. 트랜잭션 해시로 상세 정보 확인

### 시나리오 4: 지갑 전체 조회
1. 지갑조회에서 주소 입력
2. 소유한 모든 NFT 확인
3. 거래 이력 보기로 전체 거래 내역 확인

### 🆕 시나리오 5: 마켓에서 NFT 판매
1. 거래소 페이지 접속
2. NFT 판매 등록
3. 가격 설정
4. 판매 등록 완료

### 🆕 시나리오 6: 마켓에서 NFT 구매
1. 거래소 페이지 접속
2. 판매 중인 NFT 목록 확인
3. 원하는 NFT 선택
4. 구매 완료

## 🔄 다음 단계

프론트엔드 구조를 이해했으니, 다음 매뉴얼을 확인하세요:

- **[manual_5.md](./manual_5.md)**: 설치 및 실행 가이드

---

**📝 참고사항**: 프론트엔드는 백엔드 API와 완전히 연동되어 있으며, 모든 기능이 실시간으로 작동합니다.
