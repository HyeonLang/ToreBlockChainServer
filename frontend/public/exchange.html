<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TORE 거래소 - NFT 마켓플레이스</title>
    <link rel="stylesheet" href="css/exchange.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <!-- 헤더 -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <h1><i class="fas fa-gem"></i> TORE 거래소</h1>
                </div>
                <nav class="nav">
                    <a href="#marketplace" class="nav-link active">마켓플레이스</a>
                    <a href="#my-nfts" class="nav-link">내 NFT</a>
                    <a href="#my-trades" class="nav-link">거래 내역</a>
                    <a href="#auction" class="nav-link">경매</a>
                </nav>
                <div class="wallet-section">
                    <div class="wallet-info" id="walletInfo" style="display: none;">
                        <span class="wallet-address" id="walletAddress"></span>
                        <span class="tore-balance" id="toreBalance">0 TORE</span>
                    </div>
                    <button class="connect-wallet-btn" id="connectWalletBtn">
                        <i class="fas fa-wallet"></i> 지갑 연결
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- 메인 컨텐츠 -->
    <main class="main">
        <div class="container">
            <!-- 마켓플레이스 섹션 -->
            <section id="marketplace" class="section active">
                <div class="section-header">
                    <h2><i class="fas fa-store"></i> NFT 마켓플레이스</h2>
                    <div class="filters">
                        <select id="categoryFilter" class="filter-select">
                            <option value="">모든 카테고리</option>
                            <option value="weapon">무기</option>
                            <option value="armor">방어구</option>
                            <option value="accessory">악세서리</option>
                            <option value="consumable">소모품</option>
                        </select>
                        <select id="priceFilter" class="filter-select">
                            <option value="">가격 범위</option>
                            <option value="0-50">0-50 TORE</option>
                            <option value="50-100">50-100 TORE</option>
                            <option value="100-500">100-500 TORE</option>
                            <option value="500+">500+ TORE</option>
                        </select>
                        <select id="sortFilter" class="filter-select">
                            <option value="newest">최신순</option>
                            <option value="price-low">가격 낮은순</option>
                            <option value="price-high">가격 높은순</option>
                            <option value="popular">인기순</option>
                        </select>
                    </div>
                </div>
                
                <div class="nft-grid" id="nftGrid">
                    <!-- NFT 카드들이 여기에 동적으로 추가됩니다 -->
                </div>
                
                <div class="pagination" id="pagination">
                    <!-- 페이지네이션이 여기에 추가됩니다 -->
                </div>
            </section>

            <!-- 내 NFT 섹션 -->
            <section id="my-nfts" class="section">
                <div class="section-header">
                    <h2><i class="fas fa-user-circle"></i> 내 NFT</h2>
                    <button class="btn btn-primary" id="sellNftBtn">
                        <i class="fas fa-plus"></i> NFT 판매하기
                    </button>
                </div>
                
                <div class="my-nft-grid" id="myNftGrid">
                    <!-- 사용자의 NFT들이 여기에 표시됩니다 -->
                </div>
            </section>

            <!-- 거래 내역 섹션 -->
            <section id="my-trades" class="section">
                <div class="section-header">
                    <h2><i class="fas fa-history"></i> 거래 내역</h2>
                </div>
                
                <div class="trade-tabs">
                    <button class="tab-btn active" data-tab="sold">판매 내역</button>
                    <button class="tab-btn" data-tab="bought">구매 내역</button>
                    <button class="tab-btn" data-tab="active">진행중인 거래</button>
                </div>
                
                <div class="trade-list" id="tradeList">
                    <!-- 거래 내역이 여기에 표시됩니다 -->
                </div>
            </section>

            <!-- 경매 섹션 -->
            <section id="auction" class="section">
                <div class="section-header">
                    <h2><i class="fas fa-gavel"></i> 경매</h2>
                    <button class="btn btn-primary" id="createAuctionBtn">
                        <i class="fas fa-plus"></i> 경매 생성
                    </button>
                </div>
                
                <div class="auction-tabs">
                    <button class="tab-btn active" data-tab="live">진행중인 경매</button>
                    <button class="tab-btn" data-tab="ending-soon">마감 임박</button>
                    <button class="tab-btn" data-tab="ended">종료된 경매</button>
                </div>
                
                <div class="auction-grid" id="auctionGrid">
                    <!-- 경매 아이템들이 여기에 표시됩니다 -->
                </div>
            </section>
        </div>
    </main>

    <!-- 모달들 -->
    <!-- NFT 판매 모달 -->
    <div id="sellNftModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>NFT 판매하기</h3>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <form id="sellNftForm">
                    <div class="form-group">
                        <label>판매할 NFT 선택</label>
                        <select id="nftSelect" required>
                            <option value="">NFT를 선택하세요</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>판매 가격 (TORE)</label>
                        <input type="number" id="sellPrice" min="0.01" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label>거래 수수료: 2.5%</label>
                        <small>실제 받을 금액: <span id="netAmount">0 TORE</span></small>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('sellNftModal')">취소</button>
                        <button type="submit" class="btn btn-primary">판매 등록</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- NFT 구매 모달 -->
    <div id="buyNftModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>NFT 구매하기</h3>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div class="nft-preview" id="nftPreview">
                    <!-- NFT 미리보기가 여기에 표시됩니다 -->
                </div>
                <div class="purchase-info">
                    <h4 id="nftName"></h4>
                    <p class="price">가격: <span id="nftPrice"></span> TORE</p>
                    <p class="fee">수수료 (2.5%): <span id="purchaseFee"></span> TORE</p>
                    <p class="total">총 결제 금액: <span id="totalPrice"></span> TORE</p>
                    <div class="balance-check">
                        <p>내 TORE 잔액: <span id="myBalance"></span> TORE</p>
                        <p class="insufficient" id="insufficientBalance" style="display: none;">
                            <i class="fas fa-exclamation-triangle"></i> 잔액이 부족합니다.
                        </p>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('buyNftModal')">취소</button>
                    <button type="button" class="btn btn-primary" id="confirmPurchaseBtn">구매하기</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 경매 생성 모달 -->
    <div id="createAuctionModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>경매 생성하기</h3>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <form id="createAuctionForm">
                    <div class="form-group">
                        <label>경매할 NFT 선택</label>
                        <select id="auctionNftSelect" required>
                            <option value="">NFT를 선택하세요</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>시작 가격 (TORE)</label>
                        <input type="number" id="startPrice" min="0.01" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label>즉시 구매 가격 (TORE) - 선택사항</label>
                        <input type="number" id="buyNowPrice" min="0.01" step="0.01">
                    </div>
                    <div class="form-group">
                        <label>경매 종료 시간</label>
                        <input type="datetime-local" id="endTime" required>
                    </div>
                    <div class="form-group">
                        <label>경매 설명</label>
                        <textarea id="auctionDescription" rows="3"></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('createAuctionModal')">취소</button>
                        <button type="submit" class="btn btn-primary">경매 생성</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- 로딩 오버레이 -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none;">
        <div class="loading-spinner">
            <i class="fas fa-spinner fa-spin"></i>
            <p>거래를 처리중입니다...</p>
        </div>
    </div>

    <!-- 알림 토스트 -->
    <div id="toast" class="toast"></div>

    <!-- 스크립트 -->
    <script src="js/walletManager.js"></script>
    <script src="js/exchangeManager.js"></script>
    <script src="js/auctionManager.js"></script>
    <script src="js/exchangeApp.js"></script>
</body>
</html>
